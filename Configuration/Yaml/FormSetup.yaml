# Field definition
.email_template_field: &email_template_field
  identifier: emailTemplateText
  templateName: Inspector-SingleSelectTemplateEditor
  fieldExplanationText: form_custom_templates.select.fieldExplanationText
  label: form_custom_templates.select.label
  propertyPath: options.emailTemplateUid

# Definition of the additional dropdown for template selection
.email_template_options: &email_template_options
  implementationClassName: B13\FormCustomTemplates\Domain\Finisher\EmailTemplateFinisher
  options:
    templateName: '{@format}.html'
    templateRootPaths:
      99: 'EXT:form_custom_templates/Resources/Private/Frontend/Templates/Finishers/Email/'
  formEditor:
    predefinedDefaults:
      options:
        emailTemplateUid: ''
  # displayed when overriding finisher settings
  FormEngine:
    elements:
      emailTemplateText:
        label: 'form_custom_templates.select.label'
        config:
          type: text
          #renderType: selectSingle
          minitems: 1
          maxitems: 1
          size: 1
          # Yes! We have to define the available list of selectable
          # items again, because it is a different format! Partey!
          items:
            0:
              - 'form_custom_templates.select.default'
              # The default value is required for v10, otherwise this will show up as "INVALID VALUE"
              # can be set to "" (empty string) once we support v11 and up only.
              - "[Empty]"
TYPO3:
  CMS:
    Form:
      prototypes:
        standard:
          formEngine:
            translationFiles:
              97: 'EXT:form_custom_templates/Resources/Private/Language/Database.xlf'
          formEditor:
            translationFiles:
              97: 'EXT:form_custom_templates/Resources/Private/Language/Database.xlf'
            formEditorFluidConfiguration:
              partialRootPaths:
                97: 'EXT:form_custom_templates/Resources/Private/Backend/Partials/FormEditor/'
            formEditorPartials:
              Inspector-SingleSelectTemplateEditor: Inspector/SingleSelectTemplateEditor
            dynamicRequireJsModules:
              additionalViewModelModules:
                97: 'TYPO3/CMS/FormCustomTemplates/Backend/FormEditor/SelectTemplateViewModel'
          formElementsDefinition:
            Form:
              formEditor:
                propertyCollections:
                  finishers:
                    # Add finisher field
                    10:
                      identifier: EmailToSender
                      editors:
                        5000: # Position in the inspector, might override existing fields!
                          <<: *email_template_field
                    20:
                      identifier: EmailToReceiver
                      editors:
                        5000: # Position in the inspector, might override existing fields!
                          <<: *email_template_field
          finishersDefinition:
            EmailToSender:
              <<: *email_template_options
            EmailToReceiver:
              <<: *email_template_options